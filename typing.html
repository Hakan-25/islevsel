<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>HakanTools | Word Hunter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&family=Inter:wght@400;600&display=swap');

        :root {
            --bg-color: #f0f2f5;
            --sidebar-bg: #ffffff;
            --text-main: #333333;
            --text-sub: #888888;
            --accent: #3b82f6;
            --correct: #22c55e;
            --error: #ef4444;
            --cursor: #3b82f6;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            height: 100vh;
            overflow: hidden; /* No scroll on PC */
            display: flex;
        }

        /* --- LEFT PANEL --- */
        .sidebar {
            width: 280px;
            background-color: var(--sidebar-bg);
            height: 100%;
            padding: 2rem;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #e5e7eb;
            box-shadow: var(--shadow);
            z-index: 10;
            transition: all 0.3s ease;
        }

        .back-btn {
            text-decoration: none;
            color: var(--text-sub);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 3rem;
            transition: 0.2s;
            font-size: 1rem;
        }
        .back-btn:hover { color: var(--accent); }

        .record-box {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            margin-bottom: 2rem;
            transition: 0.3s;
        }
        .record-box:hover { border-color: var(--accent); transform: translateY(-2px); }

        .record-title { font-size: 0.8rem; color: var(--text-sub); margin-bottom: 5px; text-transform: uppercase; font-weight: 700; }
        .record-score { font-size: 3rem; font-weight: 800; color: var(--accent); line-height: 1; margin: 10px 0; }
        .record-unit { font-size: 0.9rem; color: var(--text-sub); font-weight: 600; }
        
        .record-date {
            margin-top: 10px;
            font-size: 0.75rem;
            color: #94a3b8;
            border-top: 1px solid #e2e8f0;
            padding-top: 8px;
        }

        .tips {
            font-size: 0.85rem;
            color: var(--text-sub);
            line-height: 1.6;
            margin-top: auto;
            border-top: 1px solid #e5e7eb;
            padding-top: 1rem;
        }

        /* --- MIDDLE AREA --- */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            width: 100%;
        }

        .config-bar {
            display: flex;
            gap: 5px;
            background: #ffffff;
            padding: 8px 15px;
            border-radius: 50px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .time-btn {
            background: none;
            border: none;
            padding: 8px 16px;
            cursor: pointer;
            color: var(--text-sub);
            font-weight: 600;
            border-radius: 20px;
            transition: 0.2s;
            font-size: 0.9rem;
        }

        .time-btn.active, .time-btn:hover {
            background-color: var(--accent);
            color: white;
        }

        .live-stats {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 1.5rem;
            font-family: 'Roboto Mono', monospace;
            background: white;
            padding: 10px 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .typing-container {
            width: 900px;
            max-width: 90%;
            height: 160px;
            overflow: hidden;
            position: relative;
            background: #ffffff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            cursor: text;
            border: 2px solid transparent;
            transition: border-color 0.3s;
        }
        
        .typing-container:focus-within { border-color: var(--accent); }

        .words-wrapper {
            font-family: 'Roboto Mono', monospace;
            font-size: 1.6rem;
            line-height: 2.5rem;
            color: #9ca3af;
            user-select: none;
            transition: transform 0.2s ease;
        }

        .word { margin-right: 12px; display: inline-block; border-bottom: 2px solid transparent; }
        .word.error-word { border-bottom-color: var(--error); }

        .letter { position: relative; }
        .letter.correct { color: var(--correct); }
        .letter.incorrect { color: var(--error); }
        
        .letter.active::before {
            content: '';
            position: absolute;
            left: 0; bottom: 2px; width: 2px; height: 80%;
            background-color: var(--cursor);
            animation: blink 1s infinite;
        }
        .letter.active.is-space::before { left: 50%; }

        @keyframes blink { 50% { opacity: 0; } }

        #input-field { position: absolute; opacity: 0; z-index: -99; }

        /* RESULT MODAL */
        .result-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: none;
            justify-content: center; align-items: center;
            z-index: 100;
            backdrop-filter: blur(5px);
        }

        .result-card {
            background: white; padding: 3rem; border-radius: 20px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            text-align: center; border: 1px solid #e5e7eb;
            max-width: 450px; width: 90%;
        }

        .result-title { font-size: 1.5rem; color: var(--text-sub); margin-bottom: 0.5rem; }
        .result-score { font-size: 5rem; color: var(--accent); font-weight: 800; line-height: 1; margin-bottom: 0.5rem; }
        .result-label { font-size: 1.2rem; color: var(--text-main); font-weight: 600; margin-bottom: 2rem; }
        
        .grid-stats {
            display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
            margin-bottom: 2rem; text-align: left;
        }
        .stat-item { background: #f3f4f6; padding: 12px; border-radius: 8px; font-size: 0.9rem; }
        .stat-item span { display: block; color: var(--text-sub); font-size: 0.8rem; margin-bottom: 3px;}
        .stat-item b { display: block; font-size: 1.1rem; color: var(--text-main); }

        .restart-btn {
            background: var(--accent); color: white; border: none;
            padding: 15px 40px; font-size: 1.1rem; border-radius: 10px;
            cursor: pointer; transition: 0.2s; font-weight: 600; width: 100%;
        }
        .restart-btn:hover { background: #2563eb; transform: translateY(-2px); }

        /* --- MOBILE RESPONSIVE --- */
        @media (max-width: 768px) {
            body {
                flex-direction: column; /* stacked instead of side-by-side */
                height: 100vh;
                overflow: hidden; /* prevent page scrolling */
            }

            /* Make Sidebar a Top Menu on Mobile */
            .sidebar {
                width: 100%;
                height: auto;
                flex-direction: row; /* content side-by-side */
                align-items: center;
                justify-content: space-between;
                padding: 10px 15px;
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
                box-shadow: none;
            }

            .back-btn { margin-bottom: 0; font-size: 0.9rem; }
            .back-btn span { display: none; } /* Hide "Main Menu" text, keep icon */
            .back-btn i { font-size: 1.2rem; }

            /* Shrink Record Box on Mobile */
            .record-box {
                margin-bottom: 0;
                padding: 5px 10px;
                display: flex;
                align-items: center;
                gap: 10px;
                border: none;
                background: transparent;
            }
            .record-title, .record-date, .record-unit, .tips { display: none; } /* hide extras */
            .record-score { font-size: 1.5rem; margin: 0; }
            .record-box::before { content: "üèÜ "; font-size: 1.2rem; } /* add trophy icon */

            /* Middle Area Settings */
            .main-content { justify-content: start; padding-top: 20px; }
            
            .config-bar { margin-bottom: 1rem; padding: 5px; }
            .time-btn { padding: 5px 10px; font-size: 0.8rem; }

            .live-stats { font-size: 1.5rem; padding: 5px 20px; margin-bottom: 1rem; }

            .typing-container {
                width: 95%;
                height: 120px; /* less space on mobile */
                padding: 15px;
            }

            .words-wrapper {
                font-size: 1.3rem; /* slightly smaller text */
                line-height: 2rem;
            }

            /* Result Screen */
            .result-card { padding: 1.5rem; width: 95%; }
            .result-score { font-size: 3.5rem; }
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <a href="index.html" class="back-btn"><i class="fas fa-arrow-left"></i> <span>Main Menu</span></a>
        
        <div class="record-box">
            <div class="record-title">BEST RECORD (<span id="record-mode-label">30s</span>)</div>
            <div class="record-score" id="best-score">0</div>
            <div class="record-unit">CORRECT WORDS</div>
            <div class="record-date" id="best-date">No Records</div>
        </div>

        <div class="tips">
            <b>Mobile Tip:</b><br>
            Disabling keyboard auto-correct will make typing smoother.<br>
        </div>
    </aside>

    <main class="main-content">
        <div class="config-bar" id="time-options">
            <button class="time-btn" onclick="setTime(15)">15s</button>
            <button class="time-btn active" onclick="setTime(30)">30s</button>
            <button class="time-btn" onclick="setTime(60)">60s</button>
            <button class="time-btn" onclick="setTime(180)">3m</button>
        </div>

        <div class="live-stats" id="timer">30</div>

        <div class="typing-container" onclick="focusInput()">
            <div class="words-wrapper" id="words-wrapper"></div>
        </div>
        
        <input type="text" id="input-field" autocomplete="off" style="font-size: 16px;">
    </main>

    <div class="result-modal" id="result-modal">
        <div class="result-card">
            <div class="result-title">Time's Up!</div>
            <div class="result-score" id="final-score">0</div>
            <div class="result-label">Correct Words</div>
            
            <div class="grid-stats">
                <div class="stat-item">
                    <span>Total Keystrokes</span>
                    <b id="stat-keystrokes">0</b>
                </div>
                <div class="stat-item">
                    <span>Accuracy</span>
                    <b id="stat-acc">%0</b>
                </div>
                <div class="stat-item" style="grid-column: span 2;">
                    <span>Date</span>
                    <b id="stat-date">--</b>
                </div>
            </div>

            <button class="restart-btn" onclick="resetGame()">Try Again</button>
        </div>
    </div>

    <script>
        // --- 1000 WORD POOL ---
        const wordPool = [
            "the", "be", "to", "of", "and", "a", "in", "that", "have", "it", "for", "not", "on", "with", "he", "as", "you", "do", "at", "this",
            "but", "his", "by", "from", "they", "we", "say", "her", "she", "or", "an", "will", "my", "one", "all", "would", "there", "their", "what", "so",
            "up", "out", "if", "about", "who", "get", "which", "go", "me", "when", "make", "can", "like", "time", "no", "just", "him", "know", "take", "people",
            "into", "year", "your", "good", "some", "could", "them", "see", "other", "than", "then", "now", "look", "only", "come", "its", "over", "think", "also", "back",
            "after", "use", "two", "how", "our", "work", "first", "well", "way", "even", "new", "want", "because", "any", "these", "give", "day", "most", "us", "water",
            "school", "many", "found", "study", "still", "learn", "should", "world", "high", "low", "deep", "shallow", "wide", "narrow", "heavy", "hard", "soft", "hot", "cold"
        ];

        let timeLeft = 30;
        let maxTime = 30;
        let isTyping = false;
        let timer = null;
        let words = [];
        let currentWordIndex = 0;
        let currentCharIndex = 0;
        
        let completedCorrectWords = 0;
        let totalKeystrokes = 0;
        let correctKeystrokes = 0;

        const wordWrapper = document.getElementById("words-wrapper");
        const inputField = document.getElementById("input-field");
        const timerTag = document.getElementById("timer");
        const resultModal = document.getElementById("result-modal");
        const timeBtns = document.querySelectorAll(".time-btn");
        
        const bestScoreTag = document.getElementById("best-score");
        const bestDateTag = document.getElementById("best-date");
        const recordModeLabel = document.getElementById("record-mode-label");

        window.onload = () => {
            loadBestScore(maxTime);
            resetGame();
        };

        function generateWords() {
            wordWrapper.innerHTML = "";
            words = [];
            for (let i = 0; i < 300; i++) {
                const randomWord = wordPool[Math.floor(Math.random() * wordPool.length)];
                words.push(randomWord);
            }
            renderWords();
        }

        function renderWords() {
            words.forEach(word => {
                const wordDiv = document.createElement("div");
                wordDiv.className = "word";
                word.split('').forEach(char => {
                    const span = document.createElement("span");
                    span.innerText = char;
                    span.className = "letter";
                    wordDiv.appendChild(span);
                });
                const spaceSpan = document.createElement("span");
                spaceSpan.innerHTML = "&nbsp;"; 
                spaceSpan.className = "letter space";
                wordDiv.appendChild(spaceSpan);
                wordWrapper.appendChild(wordDiv);
            });
            addClassToCurrentChar("active");
        }

        window.setTime = (time) => {
            if (isTyping) return;
            maxTime = time;
            timeLeft = time;
            timerTag.innerText = timeLeft;
            
            timeBtns.forEach(btn => btn.classList.remove("active"));
            event.target.classList.add("active");
            
            loadBestScore(time);
            resetGame();
        }

        window.resetGame = () => {
            generateWords();
            clearInterval(timer);
            timeLeft = maxTime;
            timerTag.innerText = timeLeft;
            isTyping = false;
            
            currentWordIndex = 0;
            currentCharIndex = 0;
            completedCorrectWords = 0;
            totalKeystrokes = 0;
            correctKeystrokes = 0;
            
            inputField.value = "";
            wordWrapper.style.transform = "translateY(0px)";
            resultModal.style.display = "none";
            focusInput();
            const firstWord = wordWrapper.children[0];
            if(firstWord) firstWord.scrollIntoView({block: "start"});
        }

        inputField.addEventListener("input", (e) => {
            if (!isTyping && timeLeft > 0) {
                isTyping = true;
                timer = setInterval(initTimer, 1000);
            }

            const val = inputField.value;
            const inputChar = val.slice(-1);
            const inputType = e.inputType;
            const currentWordDiv = wordWrapper.children[currentWordIndex];
            const chars = currentWordDiv.querySelectorAll(".letter");
            
            if (inputType === "deleteContentBackward") {
                if (currentCharIndex > 0) {
                    removeClassFromChar(currentWordIndex, currentCharIndex, "active");
                    currentCharIndex--;
                    removeClassFromChar(currentWordIndex, currentCharIndex, "correct");
                    removeClassFromChar(currentWordIndex, currentCharIndex, "incorrect");
                    addClassToCurrentChar("active");
                }
                return;
            }

            if (currentCharIndex < chars.length) {
                totalKeystrokes++;
                const targetChar = chars[currentCharIndex].innerText.replace(/\u00a0/g, " ");
                
                if (targetChar === " " && inputChar === " ") {
                    removeClassFromChar(currentWordIndex, currentCharIndex, "active");
                    
                    const hasMistake = currentWordDiv.querySelector(".incorrect");
                    
                    if (!hasMistake) {
                        completedCorrectWords++;
                    } else {
                        currentWordDiv.classList.add("error-word");
                    }

                    currentWordIndex++;
                    currentCharIndex = 0;
                    checkScroll();
                    if (currentWordIndex < words.length) addClassToCurrentChar("active");
                    inputField.value = "";
                } 
                else if (targetChar !== " ") {
                    removeClassFromChar(currentWordIndex, currentCharIndex, "active");
                    if (inputChar === targetChar) {
                        addClassToChar(currentWordIndex, currentCharIndex, "correct");
                        correctKeystrokes++;
                    } else {
                        addClassToChar(currentWordIndex, currentCharIndex, "incorrect");
                    }
                    currentCharIndex++;
                    if (currentCharIndex < chars.length) addClassToCurrentChar("active");
                }
            }
        });

        function initTimer() {
            if (timeLeft > 0) {
                timeLeft--;
                timerTag.innerText = timeLeft;
            } else {
                finishGame();
            }
        }

        function checkScroll() {
            const currentWordDiv = wordWrapper.children[currentWordIndex];
            const prevWordDiv = wordWrapper.children[currentWordIndex - 1];
            if (prevWordDiv && currentWordDiv.offsetTop > prevWordDiv.offsetTop) {
                const lineHeight = 40; 
                const currentTransform = parseInt(wordWrapper.style.transform.replace("translateY(", "").replace("px)", "") || 0);
                wordWrapper.style.transform = `translateY(${currentTransform - lineHeight}px)`;
            }
        }

        function finishGame() {
            clearInterval(timer);
            isTyping = false;
            
            let accuracy = 0;
            if (totalKeystrokes > 0) {
                accuracy = Math.round((correctKeystrokes / totalKeystrokes) * 100);
            }

            const now = new Date();
            const dateString = now.toLocaleDateString() + " " + now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

            document.getElementById("final-score").innerText = completedCorrectWords;
            document.getElementById("stat-keystrokes").innerText = totalKeystrokes;
            document.getElementById("stat-acc").innerText = `%${accuracy}`;
            document.getElementById("stat-date").innerText = dateString;

            resultModal.style.display = "flex";

            saveScore(completedCorrectWords, maxTime, dateString);
        }

        function saveScore(score, mode, dateStr) {
            let records = JSON.parse(localStorage.getItem("hakan_typing_words_records")) || {};
            let currentRecord = records[mode] || { score: 0, date: "" };

            if (score > currentRecord.score) {
                records[mode] = { score: score, date: dateStr };
                localStorage.setItem("hakan_typing_words_records", JSON.stringify(records));
                loadBestScore(mode);
            }
        }

        function loadBestScore(mode) {
            let label = mode + "s";
            if(mode === 180) label = "3m";
            recordModeLabel.innerText = label;

            let records = JSON.parse(localStorage.getItem("hakan_typing_words_records")) || {};
            let recordData = records[mode];

            if (recordData) {
                bestScoreTag.innerText = recordData.score;
                bestDateTag.innerText = recordData.date;
            } else {
                bestScoreTag.innerText = 0;
                bestDateTag.innerText = "No Records";
            }
        }

        function addClassToCurrentChar(className) { addClassToChar(currentWordIndex, currentCharIndex, className); }
        function addClassToChar(wIdx, cIdx, className) {
            const w = wordWrapper.children[wIdx];
            if(w) { const c = w.querySelectorAll(".letter")[cIdx]; if(c) c.classList.add(className); }
        }
        function removeClassFromChar(wIdx, cIdx, className) {
            const w = wordWrapper.children[wIdx];
            if(w) { const c = w.querySelectorAll(".letter")[cIdx]; if(c) c.classList.remove(className); }
        }

        window.focusInput = () => { inputField.focus(); }

        document.addEventListener("keydown", (e) => {
            if(e.key === "Tab") { e.preventDefault(); resetGame(); }
            inputField.focus();
        });

    </script>
</body>
</html>
